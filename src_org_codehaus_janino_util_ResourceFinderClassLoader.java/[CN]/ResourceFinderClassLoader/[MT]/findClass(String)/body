{
  Resource classFileResource=this.resourceFinder.findResource(ClassFile.getClassFileResourceName(className));
  if (classFileResource == null)   throw new ClassNotFoundException(className);
  InputStream is;
  try {
    is=classFileResource.open();
  }
 catch (  IOException ex) {
    throw new JaninoRuntimeException(("Opening class file resource \"" + classFileResource.getFileName() + "\": "+ ex.getMessage()),ex);
  }
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  try {
    byte[] buffer=new byte[4096];
    for (; ; ) {
      int bytesRead=is.read(buffer);
      if (bytesRead == -1)       break;
      baos.write(buffer,0,bytesRead);
    }
  }
 catch (  IOException ex) {
    throw new ClassNotFoundException("Reading class file from \"" + classFileResource + "\"",ex);
  }
 finally {
    try {
      is.close();
    }
 catch (    IOException ex) {
    }
  }
  byte[] ba=baos.toByteArray();
  Class clazz=super.defineClass(null,ba,0,ba.length);
  if (!clazz.getName().equals(className)) {
    throw new ClassNotFoundException(className);
  }
  return clazz;
}
